



<!DOCTYPE html>
<html>
    <head>
    <title>Sopa de bits</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="description" content="A blog about data, information and Tech by Mario Alberich"/>
    <meta name="keywords" content="Statistics, Data, Experimentation, Technology, Data visualization" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/static/css/bootstrap/bootstrap.css"/>
    <link rel="stylesheet" href="/static/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="/static/js/cookiecuttr/cookiecuttr.css"/>
    <link rel="stylesheet" href="/static/css/style.css"/>
    <link rel="stylesheet" href="/static/css/bootstrap/bootstrap.min.css" media="print"/>
    <link rel="stylesheet" href="/static/css/bootstrap/bootstrap-theme.min.css" media="print" />
    </head>
    <body>
    <div class="container-fluid">
      <div class="row">
        <div class="col-xs-12 col-sm-3 col-md-2 nopad-l">
          <div class="sidebar-nav-fixed affix hidden-sm">
            <div class="well">
              <div class="row">
                <!-- <div class="col-xs-12">
                  <input class="form-control" type="text" id="search-query" name="q" placeholder="Search in sopadebits.com" data-toggle="popover" autocomplete="off">
                </div> -->
                <div class="col-xs-12 text-center">
                  <a href="https://sopadebits.com"><h1>Sopa de bits</h1></a>
                </div>
                <div class="col-xs-8 col-xs-offset-2 text-center">
                  <a href="https://sopadebits.com">
                    <img src="/static/images/avatar.jpg"
                      class="img img-responsive img-circle"
                      alt="Sopa de bits"
                      title="Sopa de bits" />
                  </a>
                </div>
                <div class="col-sm-10 col-sm-offset-1 hidden-xs text-center">
                  <p>A blog about data, information and Tech by Mario Alberich</p>
                </div>
                <div class="col-sm-12 hidden-xs" rel="icons">
                  
  
    <a target="_new" href="https://linkedin.com/in/marioalberich" alt="LinkedIn" title="LinkedIn">
      <span class="icon fa fa-2x fa-linkedin"></span>
    </a>&nbsp;&nbsp;
  
  
    <a target="_new" href="https://twitter.com/sopadebits" alt="Twitter" title="Twitter">
      <span class="icon fa fa-2x fa-twitter"></span>
    </a>&nbsp;&nbsp;
  
  
  
    <a target="_new" href="https://github.com/malberich" alt="Github profile" title="Github profile">
      <span class="icon fa fa-2x fa-github"></span>
    </a>&nbsp;&nbsp;
  
  
  
    <a target="_new" href="https://marioalberich.com" alt="Portfolio" title="Portfolio">
      <span class="icon fa fa-2x fa-user"></span>
    </a>
  

                </div>
                <div class="col-sm-10 col-sm-offset-1 hidden-xs">
                  
  <!-- render_site_categories -->
  <h3>Categories</h3>
  <div class="row">
    
      <div class="col-xs-2">
        <span class="badge">45</span>
      </div>
      <div class="col-xs-10">
        <a href="/categories/documentacion/">Documentación</a>
      </div>
      <div class="col-xs-2">
        <span class="badge">40</span>
      </div>
      <div class="col-xs-10">
        <a href="/categories/economia/">Economía</a>
      </div>
      <div class="col-xs-2">
        <span class="badge">139</span>
      </div>
      <div class="col-xs-10">
        <a href="/categories/informatica/">Informática</a>
      </div>
      <div class="col-xs-2">
        <span class="badge">82</span>
      </div>
      <div class="col-xs-10">
        <a href="/categories/matematica/">Matemática</a>
      </div>
      <div class="col-xs-2">
        <span class="badge">1</span>
      </div>
      <div class="col-xs-10">
        <a href="/categories/miscelanea/">Miscelánea</a>
      </div>
      <div class="col-xs-2">
        <span class="badge">8</span>
      </div>
      <div class="col-xs-10">
        <a href="/categories/ocio/">Ocio</a>
      </div>
      <div class="col-xs-2">
        <span class="badge">11</span>
      </div>
      <div class="col-xs-10">
        <a href="/categories/personas/">Personas</a>
      </div>
      <div class="col-xs-2">
        <span class="badge">7</span>
      </div>
      <div class="col-xs-10">
        <a href="/categories/sin-categorizar/">Sin categorizar</a>
      </div>
  </div>

                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="jumbotron visible-sm visible-xs">
            <div class="row">
                <div class="col-sm-2 col-sm-offset-0 col-xs-4 col-xs-offset-4 text-center">
                    <a href="https://sopadebits.com">
                        <img src="/static/images/avatar.jpg"
                          class="img img-responsive img-circle"
                          alt="Sopa de bits"
                          title="Sopa de bits" />
                    </a>
                </div>
                <div class="col-sm-10 col-xs-12">
                    <h1 class="hidden-xs"><a href="https://sopadebits.com">Sopa de bits</a></h1>
                    <h1 class="visible-xs text-center"><a href="https://sopadebits.com">Sopa de bits</a></h1>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-10 col-sm-offset-1 col-xs-12 text-center">
                  <p>A blog about data, information and Tech by Mario Alberich</p>
                </div>
                <div class="col-xs-12" rel="icons">
                  
  
    <a target="_new" href="https://linkedin.com/in/marioalberich" alt="LinkedIn" title="LinkedIn">
      <span class="icon fa fa-2x fa-linkedin"></span>
    </a>&nbsp;&nbsp;
  
  
    <a target="_new" href="https://twitter.com/sopadebits" alt="Twitter" title="Twitter">
      <span class="icon fa fa-2x fa-twitter"></span>
    </a>&nbsp;&nbsp;
  
  
  
    <a target="_new" href="https://github.com/malberich" alt="Github profile" title="Github profile">
      <span class="icon fa fa-2x fa-github"></span>
    </a>&nbsp;&nbsp;
  
  
  
    <a target="_new" href="https://marioalberich.com" alt="Portfolio" title="Portfolio">
      <span class="icon fa fa-2x fa-user"></span>
    </a>
  

                </div>
            </div>
        </div>
        <!-- <div
          id="search-results"
          style="background-color: #fff; border: 1px solid black; z-index:125; height: 50%; overflow: scroll; display: none; position:absolute" class="col-xs-12 col-sm-4 col-sm-offset-2">
        </div> -->
        <div class="col-xs-12 col-md-10 col-md-offset-2">
          
  
    
        <h1>Simular un valor Poisson</h1>
        <p>La distribución de Poisson es la otra cara de la moneda de la distribución Exponencial. &nbsp;Mientras que la distribución exponencial nos sirve para modelizar el tiempo que transcurre entre dos sucesos independientes, la distribución de Poisson modeliza el número de sucesos que tienen lugar en una unidad de tiempo.</p><!--more-->
<p>Por ejemplo:</p>
<ul>
<li>Si queremos saber cuántas llamadas entrarán en un <em>Call Center</em> cada hora, modelizaremos en base a Poisson.</li>
<li>Si lo que queremos saber es cuánto tiempo transcurrirá entre dos llamadas a ese Call Center, modelizaremos con una distribución Exponencial.</li><br />
</ul><br />
Partiendo de esta idea, y disponiendo ya de la simulación de la distribución exponencial, la simulación de valores Poisson (por ejemplo, llamadas por minuto) puede ser como sigue:</p>
<ul>
<li>Se simula un primer valor E utilizando el generador de valores exponenciales. Esto nos indicará el tiempo que ha tardado en entrar la primera llamada.</li>
<li>Si la llamada ha tardado más de un minuto en entrar, significa que durante el primer minuto han entrado cero llamadas. Por lo tanto, ese valor de <em>Poisson</em> vale cero.</li>
<li>En caso contrario, ya ha entrado una llamada, y quizá entre una segunda. Simularemos valores exponenciales mientras las sumas de estos valores no superen la unidad de medida (en este caso, un minuto).</li>
<li>Cada vez que simulamos un valor exponencial, sumamos 1 a P.</li><br />
</ul></p>
<p>Suena un poco complicado, pero en el fondo lo puedes pensar así: arrancamos el cronómetro y lo paramos al minuto. Contamos el total de llamadas que han entrado en ese minuto por una línea. En el momento que entre una llamada después de ese minuto, ya está fuera del contador.</p></p>
<p>La distribución de Poisson, como la Exponencial, toma un solo parámetro &lambda;, pero ojo porque el valor es el inverso. Es decir, que si en la Exponencial consideramos que cada llamada tarda 30 segundos en entrar, la Poisson indicará que hay 2 llamadas por minuto. En resumen: el parámetro tiene el mismo nombre pero <strong>toma el valor inverso</strong>. En la Exponencial sería 0,5 y en la Poisson sería 1/0,5 = 2. En el fondo es más intuitivo, aunque de buenas a primeras suena a chino, hay que reconocerlo.</p></p>
<p>[d3-link]</p>
<p>[/d3-link]</p>
<style type="text/css">
            .axis path,<br />
            .axis line {<br />
                fill: none;<br />
                stroke: black;<br />
                shape-rendering: crispEdges;<br />
            }</p>
<p>         .axis text {<br />
                font-family: sans-serif;<br />
                font-size: 11px;<br />
            }<br />
        </style></p>
<p>Pues bien, hecha la explicación, vamos a por la simulación de los datos con D3:</p></p>
<p><input type="button" value="Actualiza" style="display:block" onclick="generator();void(0);"/><br/></p>
<p>[d3-source canvas="chart"]<br />
var<br />
                svg &nbsp;= null,<br />
                bars = null,</p>
<p>             generator = function() {<br />
                    var&nbsp;<br />
                        lambda = 5,<br />
                        simulations = 500,<br />
                        barWidth &nbsp; &nbsp;= 16.3,<br />
                        barsScale = d3.scale.linear()<br />
                                                .domain([0, 3 * lambda])<br />
                                                .range([0,29]);<br />
                        barXScale = d3.scale.linear()<br />
                                                .domain([0, 3 * lambda])<br />
                                                .range([0,270]);<br />
                    var dataset     = poissonGen(lambda, simulations, barsScale),                   </p>
<p>                         barYScale = d3.scale.linear()<br />
                                                    .domain([0, d3.max(dataset, function(d) { return d;})])<br />
                                                    .range([270, 0]),</p>
<p>                         yAxis       = d3.svg.axis()<br />
                                                     .scale(barYScale)<br />
                                                     .orient("left")<br />
                                                     .ticks(5),</p>
<p>                         xAxis           = d3.svg.axis()<br />
                                                     .scale(barXScale)<br />
                                                     .orient("bottom")<br />
                                                     .ticks(4);</p>
<p>                 if (svg !== null) {<br />
                        bars = svg.selectAll("rect")<br />
                            .data(dataset);</p>
<p>                     bars.enter();<br />
                    } else {<br />
                        svg = d3.select(".chart")<br />
                                .append("svg")<br />
                                .attr("width", 400)<br />
                                .attr("height", 300);</p>
<p>                     bars = svg.selectAll("rect")<br />
                                    .data(dataset)<br />
                                    .enter()<br />
                                    .append("rect");<br />
                    }</p>
<p>                 svg.selectAll("g.axis").remove();</p>
<p>                 svg.append("g")<br />
                        .attr("class", "axis")<br />
                        .attr("transform", "translate(30,0)")<br />
                        .call(yAxis);</p>
<p>                 svg.append("g")<br />
                        .attr("class", "axis")<br />
                        .attr("transform", "translate(30,270)")<br />
                        .call(xAxis);</p>
<p>                 bars.attr("x", function(d,i) {<br />
                         &nbsp; return 32 + i * (barWidth + 1);<br />
                         &nbsp;})<br />
                         &nbsp;.attr("y", function(d) {<br />
                         &nbsp; return 270-d;<br />
                         &nbsp;})<br />
                         &nbsp;.attr("width", barWidth)<br />
                         &nbsp;.attr("height", function(d) {<br />
                         &nbsp; return d;<br />
                         &nbsp;})<br />
                         &nbsp;.attr("fill", "blue");<br />
                },</p>
<p>             poissonGen = function(lambda, simulations, barXScale) {<br />
                    var datum = [];<br />
                 &nbsp; for(var row = 0; row < 30; row++) {<br />
                 &nbsp;     datum.push(0);<br />
                 &nbsp; }</p>
<p>              &nbsp; for(var i = 0; i < simulations; i++) {<br />
                 &nbsp;     var total = 0, poisson = -1;<br />
                 &nbsp;     do {<br />
                 &nbsp;         var u = Math.random();<br />
                 &nbsp;         total += (-Math.log(u)/lambda);<br />
                 &nbsp;         poisson++;<br />
                 &nbsp;     } while(total < 1);</p>
<p>              &nbsp;     datum[poisson]++;<br />
                 &nbsp; }<br />
                 &nbsp; return datum;<br />
                };<br />
generator();<br />
[/d3-source]</p>
<p>Se puede ver que en general su forma es <em>acampanada</em>. En realidad a partir de valores &lambda; superiores a 30, las formas de la distribución de Poisson y de la distribución normal son casi indistinguibles (salvo, claro, porque la primera toma valores discretos y la segunda, continuos).</p></p>
    


        </div>
        <div class="col-xs-12 col-md-10 col-md-offset-2">
          
        </div>
        <div class="col-xs-12 col-md-offset-2">
          <p class="alert text-center">
            &copy; 2007 and beyond Mario Alberich, licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC-BY-SA</a> unless stated otherwise.
          </p>
        </div>
      </div>
    </div>
    <script type="text/javascript">
    $(document).ready(
      function (){
        $.cookieCuttr();
      }
    );
    </script>
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap/bootstrap.min.js"></script>
    <script src="/static/js/search.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="/static/js/cookiecuttr/jquery.cookiecuttr.js" type="text/javascript"></script>
    <script src="/static/js/cookiecuttr/js.cookie.js"></script>
  </body>
</html>
